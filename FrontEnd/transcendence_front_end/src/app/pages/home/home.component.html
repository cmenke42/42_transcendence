<!-- SUPER USER -->
<div class="container">
  <h1 class="text-center">Welcome to Transcendence</h1>
  @if(loggedInUser?.is_superuser)
  {
      <div class="row">
          <div class="col-md-8 mx-auto">
             <table class="table table-striped">
                 <thead>
                     <tr>
                         <th>ID</th>
                         <th>E-mail</th>
                         <th>Admin</th>
                         <th>Is Active</th>
                         <th>Action</th>
                     </tr>
                 </thead>
                 <tbody>
                  @for(user of data; track user.id)
                  {
       
                      <tr>
                        <td>{{user.id}}</td>
                        <td>{{user.email}}</td>
                        <td>{{user.is_superuser ? '✓' : '✗'}}</td>
                        <td>{{user.is_active ? '✓' : '✗'}}</td>
                        <td>
                           <button *ngIf="user.is_active" class="btn btn-outline-danger" (click)="toggleUserActivation(user.id, 'deactivate')">Deactivate</button>
                           <button *ngIf="!user.is_active" class="btn btn-outline-primary" (click)="toggleUserActivation(user.id, 'activate')">Activate</button>
                         </td>
                    </tr>
                

                    
                  }
                  @empty 
                  {
                      <tr>
                          <td colspan="4" class="text-center">No data</td>
                      </tr>
                  }
                 </tbody>
                </table>
          </div>
      </div>
      
        
    }@else {
<!-- NORMAL USER -->
    <div class="container d-flex justify-content-center align-items-center" style="height: 75vh;">
      <div class="col-md-6 col-lg-4 p-4 border">
        <h2 class="text-center">Hello, {{ user_profile?.nickname }} </h2>
    <!-- INTRA USER -->
              @if(loggedInUser?.is_intra_user) {
                <img [src]="user_profile?.intra_avatar" alt="User Avatar" class="img-fluid mb-3">
                <br>
                <button class="btn btn-outline-danger" (click)="toggleUserActivation(loggedInUser?.id, 'deactivate')">Deactivate</button>
              } @else { 
    <!-- NOT INTRA USER -->
                <form (ngSubmit)="saveProfileChanges()">
                    <div class="mb-3">
                      <label for="nickname" class="form-label">New nickname:</label>

                      <input type="text" id="nickname" name="nickname" [(ngModel)]="newNickname" class="form-control">
                    </div>
                    
                    <div class="mb-3">
                        <label for="avatar" class="form-label">Avatar:</label>
                        <input type="file" id="avatar" (change)="onFileSelected($event)" class="form-control">
                      </div>
                    
                    @if(user_profile?.avatar) {
                         <img [src]="user_profile?.avatar" alt="User Avatar" class="img-fluid mb-3"> 
                          
                      } @else {
                        <p>No avatar uploaded</p>
                      }                    
                      <div class="d-flex justify-content-between">
                        <button type="submit" class="btn btn-primary">Save Changes</button>
                        <button class="btn btn-danger" (click)="toggleUserActivation(loggedInUser?.id, 'deactivate')">Deactivate</button>
                    </div>
                  </form>
                }
              </div>
            </div>
          
              
    } 
      
</div>
